{% extends 'crashviewer/base.html' %}
{% load crashviewer_filters %}

{% block content %}

<script>
function myFunction(idx) {
	div = 'mydiv' + idx
    var x = document.getElementById(div);
    if (x.style.display === 'block') {
        x.style.display = 'none';
    } else {
        x.style.display = 'block';
    }
}
</script>

<div class="row">
	<div class="col-md-12">
		<div>
			<h1>{{ project.name }}</h1>

			<a href="{% url 'project_detail' pk=project.pk %}">
				All
			</a>

			<a href="{% url 'project_detail' pk=project.pk %}?maxbt=3">
				3
			</a>
			<a href="{% url 'project_detail' pk=project.pk %}?maxbt=5">
				5
			</a>

			/
			<a href="{% url 'project_detail_u' pk=project.pk %}">
				Unique
			</a>

			<a href="{% url 'project_detail_u' pk=project.pk %}?maxbt=3">
				3
			</a>
			<a href="{% url 'project_detail_u' pk=project.pk %}?maxbt=5">
				5
			</a>


			<br>


			<p>Comment: {{ project.comment|linebreaksbr }}</p>
			<hr>
		</div>
	</div>
</div>

<div class="row">
	<div class="col-md-1">
		Seed
	</div>
	<div class="col-md-2">
		Code Addr
	</div>
	<div class="col-md-1">
		Pos / Ded / Sig
	</div>
	<div class="col-md-1">
		Msg Idx
	</div>

	<div class="col-md-1">
		Cause
	</div>

	<div class="col-md-5">
		Backtrace
	</div>
	<div class="col-md-1">

	</div>
</div>

{% for crashData in crashDataList %}
<div class="row">
	<div class="col-md-1">
		{{ crashData.seed|shortseed }}
	</div>
	<div class="col-md-2">
		{{ crashData.codeoff|myhex }} /
		{{ crashData.codeaddr|myhex }}
	</div>
	<div class="col-md-1">
		{{ crashData.fuzzerpos }} / {{ crashData.reallydead }} / {{ crashData.signal }}
	</div>
	<div class="col-md-1">
		{{ crashData.fuzzedMsgIdx }}
	</div>

	<div class="col-md-1">
		{{ crashData.cause }}
	</div>

	<div class="col-md-5">
		{{ crashData.backtrace|linebreaks }}
	</div>

	<div class="col-md-1">
		<button onclick="myFunction({{crashData.pk}})">Info</button>
	</div>
</div>
<div class="row crashDataDetails border-top" id="mydiv{{crashData.pk}}">
	<div class="col-md-2 asanOutput">
		{{ crashData.asanoutput|linebreaks }}
	</div>
	<div class="col-md-2 asanOutput">
		{{ crashData.gdboutput|linebreaks }}
	</div>
	<div class="col-md-2 asanOutput">
		{{ crashData.stdout|linebreaks }}
	</div>
	<div class="col-md-4">
		<table border="1" width="100%">
		{% for msg in crashData.messageList.all %}
			<tr>
				<td>{{ msg.index }}</td>
				<td>{{ msg.sentBy }}</td>
				<td class="msgfuzz{{msg.fuzzed}}">
					{{ msg.msg|myhexblong }}
				</td>
			</tr>
		{% endfor %}
		</table>
	</div>
</div>

{% endfor %}

{% endblock %}
